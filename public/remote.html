<!DOCTYPE html>
<html>
<head>
	<title>Remote</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
	<style>
		body{font-family:sans-serif;display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;touch-action:manipulation;}
		.d-pad{display:grid;grid-template-columns:1fr 1fr 1fr;grid-template-rows:1fr 1fr 1fr;width:180px;height:180px;}
		.d-pad button{font-size:24px;border:1px solid #ccc;background:#f0f0f0;cursor:pointer;user-select:none;}
		.d-pad button:active{background:#bbb;}
		#ok-btn{grid-column:2;grid-row:2;border-radius:50%;}
		#up-btn{grid-column:2;grid-row:1;}
		#down-btn{grid-column:2;grid-row:3;}
		#left-btn{grid-column:1;grid-row:2;}
		#right-btn{grid-column:3;grid-row:2;}
	</style>
</head>
<body>
	<div class="d-pad">
		<button id="up-btn">▲</button>
		<button id="left-btn">◀</button>
		<button id="ok-btn">OK</button>
		<button id="right-btn">▶</button>
		<button id="down-btn">▼</button>
	</div>
	<script src="/socket.io/socket.io.js"></script>
	<script>
		const socket = io({ transports: ['websocket'], upgrade: false });
		const statusEl = document.createElement('div');
		statusEl.style.position = 'fixed';
		statusEl.style.bottom = '8px';
		statusEl.style.right = '8px';
		statusEl.style.padding = '6px 8px';
		statusEl.style.background = 'rgba(0,0,0,0.6)';
		statusEl.style.color = '#fff';
		statusEl.style.fontSize = '12px';
		statusEl.style.borderRadius = '4px';
		statusEl.innerText = 'connecting...';
		document.body.appendChild(statusEl);

		socket.on('connect', () => statusEl.innerText = 'connected');
		socket.on('disconnect', () => statusEl.innerText = 'disconnected');

		function sendInput(key){
			socket.emit('remote-input', { key });
		}

		function wireButton(id, key){
			const el = document.getElementById(id);
			['click','touchstart'].forEach(evt => el.addEventListener(evt, (e) => {
				// Prevent double firing and page zoom
				e.preventDefault();
				e.stopPropagation();
				sendInput(key);
			}, { passive: false }));
		}

		wireButton('up-btn','up');
		wireButton('left-btn','left');
		wireButton('ok-btn','ok');
		wireButton('right-btn','right');
		wireButton('down-btn','down');
	</script>
</body>
</html>
